<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:loc="using:EasyExtractCrossPlatform.Localization"
        xmlns:viewModels="using:EasyExtractCrossPlatform.ViewModels"
        x:Class="EasyExtractCrossPlatform.SettingsWindow"
        x:DataType="viewModels:SettingsViewModel"
        Title="{loc:Loc SettingsWindow_Title}"
        Width="880"
        Height="720"
        MinWidth="760"
        MinHeight="560"
        WindowStartupLocation="CenterOwner"
        TransparencyLevelHint="AcrylicBlur"
        TransparencyBackgroundFallback="{DynamicResource EasyWindowBackgroundBrush}"
        Background="{DynamicResource EasyWindowBackgroundBrush}"
        Foreground="{DynamicResource EasyTextColorBrush}">
    <Window.Styles>
        <Style Selector="Border.section">
            <Setter Property="Background" Value="{DynamicResource EasyGlassGradientBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource EasyGlassBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="24" />
            <Setter Property="Padding" Value="24" />
            <Setter Property="Margin" Value="0,0,0,24" />
            <Setter Property="BoxShadow" Value="0 18 42 0 #16000000" />
        </Style>
        <Style Selector="ScrollViewer.settings-scroll">
            <Setter Property="HorizontalScrollBarVisibility" Value="Disabled" />
            <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
        </Style>
        <Style Selector="Window.cozy ScrollViewer.settings-scroll">
            <Setter Property="Margin" Value="24,0,24,24" />
        </Style>
        <Style Selector="Window.compact ScrollViewer.settings-scroll">
            <Setter Property="Margin" Value="16,0,16,16" />
        </Style>
        <Style Selector="Window.cozy Border.header-card">
            <Setter Property="Margin" Value="24" />
            <Setter Property="Padding" Value="24" />
        </Style>
        <Style Selector="Window.compact Border.header-card">
            <Setter Property="Margin" Value="16" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="CornerRadius" Value="22" />
        </Style>
        <Style Selector="Window.compact Border.section">
            <Setter Property="Padding" Value="18" />
            <Setter Property="CornerRadius" Value="18" />
            <Setter Property="Margin" Value="0,0,0,18" />
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,*">
        <Border Classes="header-card"
                Padding="28"
                Margin="32"
                CornerRadius="28"
                Background="{DynamicResource EasyGlassGradientBrush}"
                BorderBrush="{DynamicResource EasyGlassBorderBrush}"
                BorderThickness="1"
                BoxShadow="0 32 68 0 #15000000">
            <StackPanel>
                <TextBlock Text="{loc:Loc SettingsWindow_Header}" Classes="display" />
                <TextBlock Text="{loc:Loc SettingsWindow_Subheader}"
                           Classes="subtle"
                           Margin="0,6,0,0" />
                <TextBlock Text="{Binding LoadErrorMessage}"
                           Margin="0,12,0,0"
                           Foreground="{DynamicResource EasyWarningBrush}" />
            </StackPanel>
        </Border>

        <ScrollViewer Grid.Row="1"
                      Classes="settings-scroll"
                      Margin="32,0,32,32">
            <StackPanel>
                <Border Classes="section">
                    <StackPanel Spacing="18">
                        <TextBlock Text="{loc:Loc SettingsWindow_GeneralTitle}" FontSize="20" FontWeight="SemiBold" />
                        <TextBlock Text="{loc:Loc SettingsWindow_GeneralDescription}" Classes="subtle" />

                        <StackPanel Spacing="10">
                            <TextBlock Text="{loc:Loc SettingsWindow_AppTitleLabel}" />
                            <TextBlock Text="{Binding Settings.AppTitle}" />
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="{loc:Loc SettingsWindow_OutputPathLabel}" />
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <TextBox x:Name="DefaultOutputPathBox"
                                         Text="{Binding Settings.DefaultOutputPath}"
                                         VerticalAlignment="Center" />
                                <Button Grid.Column="1"
                                        Content="{loc:Loc SettingsWindow_OpenFolder}"
                                        Margin="12,0,0,0"
                                        Click="OpenOutputPath_OnClick"
                                        Width="120" />
                                <Button Grid.Column="2"
                                        Content="{loc:Loc SettingsWindow_Browse}"
                                        Margin="12,0,0,0"
                                        Click="BrowseOutputPath_OnClick"
                                        Width="120" />
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="{loc:Loc SettingsWindow_TempPathLabel}" />
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <TextBox x:Name="DefaultTempPathBox"
                                         Text="{Binding Settings.DefaultTempPath}"
                                         VerticalAlignment="Center" />
                                <Button Grid.Column="1"
                                        Content="{loc:Loc SettingsWindow_OpenFolder}"
                                        Margin="12,0,0,0"
                                        Click="OpenTempPath_OnClick"
                                        Width="120" />
                                <Button Grid.Column="2"
                                        Content="{loc:Loc SettingsWindow_Browse}"
                                        Margin="12,0,0,0"
                                        Click="BrowseTempPath_OnClick"
                                        Width="120" />
                            </Grid>
                        </StackPanel>

                        <WrapPanel>
                            <ToggleSwitch x:Name="ContextMenuToggle"
                                          Content="{loc:Loc SettingsWindow_ContextMenuToggle}"
                                          Margin="0,0,18,12"
                                          IsChecked="{Binding Settings.ContextMenuToggle}" />
                            <ToggleSwitch x:Name="DiscordRpcToggle"
                                          Content="{loc:Loc SettingsWindow_DiscordToggle}"
                                          Margin="0,0,18,12"
                                          IsChecked="{Binding Settings.DiscordRpc}" />
                            <ToggleSwitch x:Name="UwUModeToggle"
                                          Content="{loc:Loc SettingsWindow_UwUToggle}"
                                          Margin="0,0,18,12"
                                          IsChecked="{Binding Settings.UwUModeActive}" />
                            <ToggleSwitch x:Name="CategoryStructureToggle"
                                          Content="{loc:Loc SettingsWindow_CategoryStructureToggle}"
                                          Margin="0,0,0,12"
                                          IsChecked="{Binding Settings.ExtractedCategoryStructure}" />
                            <ToggleSwitch x:Name="SecurityScanToggle"
                                          Content="{loc:Loc SettingsWindow_SecurityScanToggle}"
                                          Margin="18,0,0,12"
                                          IsChecked="{Binding Settings.EnableSecurityScanning}" />
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <Border Classes="section">
                    <StackPanel Spacing="18">
                        <TextBlock Text="{loc:Loc SettingsWindow_AudioTitle}" FontSize="20" FontWeight="SemiBold" />
                        <TextBlock Text="{loc:Loc SettingsWindow_AudioDescription}" Classes="subtle" />

                        <ToggleSwitch x:Name="SoundToggle"
                                      Content="{loc:Loc SettingsWindow_SoundToggle}"
                                      IsChecked="{Binding Settings.EnableSound}" />

                        <StackPanel>
                            <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,6">
                                <TextBlock Grid.Column="0"
                                           Text="{loc:Loc SettingsWindow_VolumeLabel}" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding Settings.SoundVolume, StringFormat='{}{0:P0}'}"
                                           HorizontalAlignment="Right"
                                           Margin="12,0,0,0" />
                            </Grid>
                            <Slider x:Name="SoundVolumeSlider"
                                    Minimum="0"
                                    Maximum="1"
                                    TickFrequency="0.05"
                                    IsSnapToTickEnabled="True"
                                    Value="{Binding Settings.SoundVolume}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Classes="section">
                    <StackPanel Spacing="18">
                        <TextBlock Text="{loc:Loc SettingsWindow_AppearanceTitle}" FontSize="20" FontWeight="SemiBold" />
                        <TextBlock Text="{loc:Loc SettingsWindow_AppearanceDescription}" Classes="subtle" />

                        <StackPanel Orientation="Horizontal" Spacing="18">
                            <StackPanel Width="220">
                                <TextBlock Text="{loc:Loc SettingsWindow_ThemeLabel}" />
                                <ComboBox x:Name="ThemeComboBox"
                                          ItemsSource="{Binding ThemeOptions}"
                                          SelectedIndex="{Binding Settings.ApplicationTheme}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Spacing="12">
                            <StackPanel>
                                <TextBlock Text="{loc:Loc SettingsWindow_BackgroundTitle}" />
                                <ToggleSwitch x:Name="CustomBackgroundToggle"
                                              Content="{loc:Loc SettingsWindow_BackgroundToggle}"
                                              IsChecked="{Binding Settings.CustomBackgroundImage.IsEnabled}" />
                                <TextBox x:Name="BackgroundPathBox"
                                         Text="{Binding Settings.CustomBackgroundImage.BackgroundPath}"
                                         IsEnabled="{Binding IsChecked, ElementName=CustomBackgroundToggle}" />
                                <StackPanel Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="{loc:Loc SettingsWindow_OpacityLabel}" />
                                    <Slider x:Name="BackgroundOpacitySlider"
                                            Width="240"
                                            Minimum="0"
                                            Maximum="1"
                                            TickFrequency="0.05"
                                            IsSnapToTickEnabled="True"
                                            Value="{Binding Settings.CustomBackgroundImage.BackgroundOpacity}"
                                            IsEnabled="{Binding IsChecked, ElementName=CustomBackgroundToggle}" />
                                    <TextBlock
                                        Text="{Binding Value, ElementName=BackgroundOpacitySlider, StringFormat='{}{0:F2}'}"
                                        Width="50"
                                        TextAlignment="Right" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Classes="section">
                    <StackPanel Spacing="18">
                        <TextBlock Text="{loc:Loc SettingsWindow_DiagnosticsTitle}" FontSize="20" FontWeight="SemiBold" />
                        <TextBlock Text="{loc:Loc SettingsWindow_DiagnosticsDescription}" Classes="subtle" />

                        <WrapPanel>
                            <ToggleSwitch x:Name="StackTraceToggle"
                                          Content="{loc:Loc SettingsWindow_StackTraceToggle}"
                                          Margin="0,0,18,12"
                                          IsChecked="{Binding Settings.EnableStackTrace}" />
                            <ToggleSwitch x:Name="PerformanceLoggingToggle"
                                          Content="{loc:Loc SettingsWindow_PerformanceToggle}"
                                          Margin="0,0,0,12"
                                          IsChecked="{Binding Settings.EnablePerformanceLogging}" />
                        </WrapPanel>

                        <WrapPanel>
                            <ToggleSwitch x:Name="MemoryTrackingToggle"
                                          Content="{loc:Loc SettingsWindow_MemoryToggle}"
                                          Margin="0,0,18,12"
                                          IsChecked="{Binding Settings.EnableMemoryTracking}" />
                            <ToggleSwitch x:Name="AsyncLoggingToggle"
                                          Content="{loc:Loc SettingsWindow_AsyncLoggingToggle}"
                                          Margin="0,0,0,12"
                                          IsChecked="{Binding Settings.EnableAsyncLogging}" />
                        </WrapPanel>

                        <Button Content="{loc:Loc SettingsWindow_OpenLogFolder}"
                                HorizontalAlignment="Left"
                                Width="180"
                                Click="OpenLogFolder_OnClick"
                                ToolTip.Tip="{loc:Loc SettingsWindow_OpenLogFolderTooltip}" />
                    </StackPanel>
                </Border>

                <Border Classes="section">
                    <StackPanel Spacing="18">
                        <TextBlock Text="{loc:Loc SettingsWindow_UpdatesTitle}" FontSize="20" FontWeight="SemiBold" />
                        <TextBlock Text="{loc:Loc SettingsWindow_UpdatesDescription}" Classes="subtle" />

                        <ToggleSwitch x:Name="AutoUpdateToggle"
                                      Content="{loc:Loc SettingsWindow_AutoUpdateToggle}"
                                      IsChecked="{Binding Settings.Update.AutoUpdate}" />

                        <StackPanel Spacing="8">
                            <StackPanel Spacing="4">
                                <TextBlock Text="{loc:Loc SettingsWindow_RepositoryOwnerLabel}" Classes="subtle" />
                                <TextBlock Text="{Binding RepositoryOwner}" />
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{loc:Loc SettingsWindow_RepositoryNameLabel}" Classes="subtle" />
                                <TextBlock Text="{Binding RepositoryName}" />
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{loc:Loc SettingsWindow_CurrentVersionLabel}" Classes="subtle" />
                                <TextBlock Text="{Binding CurrentVersion}" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>
                <Border Classes="section" Margin="0">
                    <TextBlock x:Name="StatusTextBlock"
                               Classes="subtle"
                               VerticalAlignment="Center"
                               TextWrapping="Wrap" />
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>